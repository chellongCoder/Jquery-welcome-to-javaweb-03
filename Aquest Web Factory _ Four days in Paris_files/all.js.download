var $Page,wHeight,wWidth;var pc=true,device=true,ltIE=false,ie=false;var goOut=false,goFull=false,timeout,len,semItems=true,firstClick=true,semVideo=false,gomusic=true;var day="13",imgLoad,internalSocial=false;var canAddItems=true,canAddItemsGrid=true;$(function(){$Page=(function(){var clickHandler=('ontouchstart'in document.documentElement?"touchstart":"click");$cont={intro:$("#intro"),loader:$("#loader"),home:$("#home"),grid:$("#grid"),overlay:$(".overlay"),player:$("#player"),canvas:$("#myCanvas")},init=function(){detectBrowser();sizePage();events();startLoad();},sizePage=function(){wHeight=$(window).height();wWidth=$(window).width();fullscreen();if($cont.grid.hasClass("grid-active")==false){$cont.grid.css({y:wHeight});}
else{updateWall();}},updateWall=function(year){var idWall="#main-grid";var new_width,nb,dimItem;new_width=wWidth;if(wWidth>768){if(wWidth<=1180){dimItem=240;}
if(wWidth<=1380&&wWidth>1180){dimItem=280;}
if(wWidth<=1480&&wWidth>1380){dimItem=300;}
if(wWidth<=1720&&wWidth>1480){dimItem=350;}
if(wWidth>1720){dimItem=400;}}
else{dimItem=300;}
nb=Math.floor(new_width/dimItem);var width=new_width/nb;var x,y;var molt=1;$('#main-grid .item').each(function(id){x=(id%nb)*width;y=id==0?0:Math.floor(id/nb)*width;$(this).css('width',width+'px').css("opacity","1").css('height',(width*molt)+'px').css('left',x).css('top',(y*molt));});$('#main-grid').height((y*molt)+(width*molt));},events=function(){if(!$.support.transition)
$.fn.transition=$.fn.animate;var nrThumb=16;var maingrid=$('#main-grid');$cont.grid.css({y:wHeight});this.map={cont:$("#mapClouds")};this.$social={obj:element={dotExternal:$(".dot-external"),dotInternal:$(".dot-internal"),slider:$("#slider"),circleCont:$("#circle-cont"),internalText:$(".internal-text"),externalText:$(".external-text"),dayDot:$(".day-dot"),dayActive:$("#day-active,.current-day")},getDayText:function(day){var daytext="";if(day=="13"){daytext="February . 13 . Thursday";}
else if(day=="14"){daytext="February . 14 . Friday";}
else if(day=="15"){daytext="February . 15 . Saturday";}
else if(day=="16"){daytext="February . 16 . Sunday";}
return daytext;},preload:function(day){var daytext=$social.getDayText(day);var $slider=$('#slider');var semAjax=true;$social.obj.externalText.removeClass("active");$social.obj.dayDot.fadeOut(600);$.ajax({type:"POST",url:"/ajax.aspx/getItems",data:"{from: 1, to: 10, day: "+day+", type:1}",contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(){},success:function(msg){if(msg.d.length){$social.obj.dayActive.text(daytext);var divs=msg.d.split("|");for(i=0;i<10;i++){$slider.append(divs[i]);if(i==9){$slider.cycle({timeout:0,speed:400,prev:'#prev, #prev-text',next:'#next,#next-text',startingSlide:0,after:onAfter,before:onAfter});$social.loadImage($slider);}}}}});$.ajax({type:"POST",url:"/ajax.aspx/getLength",data:"{day: '"+day+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(msg){len=parseInt(msg.d);}});function onAfter(curr,next,opts){if(opts.addSlide&&semAjax){var userpic=$(next).data("user-pic");var username=$(next).data("user-name");var totParz=element.slider.find('.item').length;var currentSlide=opts.currSlide;$('#prev')[currentSlide==0?'hide':'show']();$('#next')[currentSlide==opts.slideCount-1?'hide':'show']();$('#dot-bottom').find("a").css({"background-image":"url("+userpic+")"});$('#user-text').text("@"+username);if(currentSlide===(totParz-2)&&totParz!=len){semAjax=false;$.ajax({type:"POST",url:"/ajax.aspx/getItems",data:"{from: "+(totParz+1)+", to: "+(totParz+10)+", day: "+day+", type: 1}",contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(){},success:function(msg){if(msg.d.length){var divs=msg.d.split("|");for(i=0;i<10;i++){if(typeof divs[i]!=="undefined")
{opts.addSlide(divs[i]);}
if(i==9){semAjax=true;}}}}});}}}},loadImage:function(contSlider){loadCircleCanvas(contSlider);contSlider.imagesLoaded().always(function(instance){setTimeout(function(){$social.open();},500);});},open:function(daytext){var userpic=$("#slider").find(".item").eq(0).data("user-pic");var username=$("#slider").find(".item").eq(0).data("user-name");$("#user-text").text("@"+username);$("#dot-bottom").find("a").css({"background-image":"url("+userpic+")"});element.dotExternal.hide();element.dotInternal.show();if(ie){element.circleCont.find("#circle-home").transition({rotateY:'-180deg'},1000);element.circleCont.find("#circle-social").transition({rotateY:'0deg'},1000);}
else{element.circleCont.transition({rotateY:'-180deg'},1000);}
$("#prev").hide();$("#back,#logo-home").show().transition({opacity:1},300);setTimeout(function(){element.internalText.addClass("active");element.dayDot.fadeIn();$("#dot-bottom").find("a").transition({scale:1,opacity:1},400);},600);},close:function(){element.dotExternal.show();element.dotInternal.hide();element.internalText.removeClass("active");setTimeout(function(){element.externalText.addClass("active");},500);if(ie){element.circleCont.find("#circle-home").transition({rotateY:'0deg'},1000);element.circleCont.find("#circle-social").transition({rotateY:'-180deg'},1000);}
else{element.circleCont.transition({rotateY:'0deg'},1000);}
setTimeout(function(){element.slider.empty();element.slider.cycle('destroy');},1200);$("#back,#logo-home").transition({opacity:0},300);},closeFromVideo:function(){internalSocial=false;element.dotExternal.show();element.dotInternal.hide();element.internalText.removeClass("active");setTimeout(function(){element.externalText.addClass("active");},500);setTimeout(function(){element.slider.fadeOut('300',function(){$(this).empty();})
element.slider.cycle('destroy');},1200);$("#back,#logo-home").transition({opacity:0},300);}};this.$grid={open:function(day,move){var foundItems=$("#main-grid").find(".item").length;var dayItems=$("#main-grid").find(".item:eq(0)").data("day");if(foundItems==0&&day!=dayItems||typeof dayItems!="undefined"){$.ajax({type:"POST",url:"/ajax.aspx/getLength",data:"{day: '"+day+"'}",contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(){},success:function(msg){len=parseInt(msg.d);}});$.ajax({type:"POST",url:"/ajax.aspx/getItemsNotSplitted",data:"{from: 1, to: "+nrThumb+", day: "+day+", type: 2}",contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(){},success:function(msg){if(msg.d.length){maingrid.empty();var divs=msg.d;maingrid.append(divs);$grid.loadGrid(move);}}});}
else{$grid.loadGrid(move);}},loadGrid:function(move){loadCircleCanvas(maingrid);maingrid.imagesLoaded().done(function(instance){updateWall();if(move){setTimeout(function(){$cont.grid.scrollTop(0);$cont.home.transition({y:-wHeight},900,"easeOutExpo");$cont.grid.transition({y:0},900,"easeOutExpo",function(){$cont.grid.css('transform','').addClass("grid-active");$(".load-more").show().css({opacity:1});$cont.player.css({'bottom':'auto','top':'30px'}).transition({opacity:1},500);if(internalSocial){element.internalText.removeClass("active");}
else{element.externalText.removeClass("active");}});},1000);}
else{updateWall();maingrid.transition({opacity:1},400,function(){$(".load-more").show().css({opacity:1});});}});},close:function(){resetProgress();function resetProgress(){loadedImageCount=0;setTimeout(function(){$cont.canvas.transition({opacity:0},200);},800);}
$cont.player.transition({opacity:0},500,function(){$cont.player.css({'bottom':'30px','top':'auto'});});$cont.home.transition({y:0},900,"easeInOutExpo");$cont.grid.removeClass("grid-active").transition({y:wHeight},900,"easeInOutExpo",function(){$cont.grid.css({"z-index":"1"});maingrid.empty().removeAttr("style");$cont.home.css('transform','');$cont.player.transition({opacity:1},500);if(internalSocial){element.internalText.addClass("active");}
else{element.externalText.addClass("active");}});},addItems:function(day){$(".loadmoreImg").addClass("animate");nrThumb=$("#main-grid").find(".item").length;var nrThumbTo=nrThumb+16
if(semItems){semItems=false;$.ajax({type:"POST",url:"/ajax.aspx/getItemsNotSplitted",data:"{from: "+(nrThumb+1)+", to: "+nrThumbTo+", day:"+day+", type:2}",contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(){},success:function(msg){if(msg.d.length){var divs=msg.d.split("|");maingrid.imagesLoaded().always().append(divs);$(".loadmoreImg").removeClass("animate");semItems=true;updateWall();if(nrThumbTo>=len){$(".load-more").hide().css({"opacity":0});}}}});}}};var myVid;this.$video={obj:v={circlePlayer:$("#circle-player"),circleVideo:$("#circle-video"),back:$("#back-home")},init:function(dayVideo,offset){var idVideo="video-day-"+dayVideo;var dayTextV="";if(dayVideo=="1"){dayTextV="FEBRUARY . 13 . Thursday";}
else if(dayVideo=="2"){dayTextV="FEBRUARY . 14 . Friday";}
else if(dayVideo=="3"){dayTextV="FEBRUARY . 15 . Saturday";}
else if(dayVideo=="4"){dayTextV="FEBRUARY . 16 . Sunday";}
$("#circle-player").find("h3").text(dayTextV);if(firstClick){firstClick=false;$video.open(idVideo,offset);}
else{$video.playVideo(idVideo,offset);}},playVideo:function(idVideo,offset){myVid=document.getElementById(idVideo);myVid.play();$("#circle-player").find("h1").text("PLAY");$("video").each(function(){var self=$(this);var video=document.getElementById(self.attr("id"));var isPlaying=video.currentTime>0&&!video.ended;if(self.attr("id")!=idVideo&&isPlaying){video.pause();video.currentTime=0;}
else{$video.caricamento(myVid,offset);}
if(self.attr("id")!=idVideo){self.hide();}
else{self.show();}});},open:function(dayVideo,offset){if(player.currents.status==="playing"){player.pause();}
$("#video-container").fadeIn();v.circlePlayer.show();$social.closeFromVideo();circle.internal.transition({opacity:0},500,"easeInOutBack");circle.external.delay(300).transition({scale:'0.9',opacity:0},500,"easeInOutBack",function(){if(ie){element.circleCont.find("#circle-home").transition({rotateY:'-180deg'},1000);element.circleCont.find("#circle-social").transition({rotateY:'0deg'},1000);}
else{element.circleCont.transition({rotateY:'-180deg'},800);}
v.circlePlayer.transition({scale:'1',opacity:1},800,"easeInOutBack",function(){v.circleVideo.addClass("player-mode");setTimeout(function(){$(".map-container").transition({opacity:0},500);$("#player").fadeOut();$cont.overlay.transition({opacity:0},500,function(){v.back.css({"display":"block"}).transition({opacity:1},300);$("#logo-home").show().css({"opacity":"1"});});},1000);setTimeout(function(){$video.playVideo(dayVideo,offset);},500);});});},playpause:function(){semVideo=true;var isPlayingMyVid=myVid.currentTime>0&&!myVid.paused&&!myVid.ended;if(isPlayingMyVid){myVid.pause();$("#circle-player").find("h1").text("PAUSE");}
else{myVid.play();$("#circle-player").find("h1").text("PLAY");}},close:function(){firstClick=true;$("#player").fadeIn();$(".map-container").transition({opacity:1},500);$cont.overlay.transition({opacity:0.7},500,function(){v.back.css({"opacity":"0","display":"none"});$("#logo-home").hide().css({"opacity":"0"});if(player.currents.status==="paused"&&gomusic){setTimeout(function(){player.resume();},500);}});setTimeout(function(){v.circlePlayer.transition({scale:'0.8',opacity:0},500,"easeInOutBack",function(){v.circleVideo.removeClass("player-mode");});setTimeout(function(){circle.external.transition({scale:'1',opacity:1},500,"easeInOutBack",function(){circle.internal.transition({opacity:1},400);element.slider.show()
if(ie){element.circleCont.find("#circle-home").transition({rotateY:'0deg'},1000);element.circleCont.find("#circle-social").transition({rotateY:'-180deg'},1000);}
else{element.circleCont.transition({rotateY:'0deg'},1000);}
v.circlePlayer.hide();$("#video-container").fadeOut();});},300);},500);$("video").each(function(){var self=$(this);var video=document.getElementById(self.attr("id"));var isPlaying=video.currentTime>0&&!video.ended;if(isPlaying){video.pause();video.currentTime=0;ctx.clearRect(0,0,canvasTime.width,canvasTime.height);}});},caricamento:function(myVid,offset){var vid=myVid;loop();ctx.clearRect(0,0,canvasTime.width,canvasTime.height);function loop(){var b=vid.buffered,i=b.length,w=canvasTime.width/2,h=canvasTime.height/2,radius=200,circ=Math.PI*2,quart=Math.PI*offset,vl=vid.duration,x1;x1=vid.currentTime/vl;x1=x1||0;ctx.lineWidth=3;ctx.strokeStyle='#FF4D4D';ctx.beginPath();ctx.arc(w,h,radius,-quart,(circ*x1)-quart);ctx.stroke();if(x1<1){setTimeout(loop,2500);}
else{ctx.clearRect(0,0,canvasTime.width,canvasTime.height);}}}}
$(document).on("click",'#circle-player',function(){$video.playpause();});$(document).on(clickHandler,'.discover',function(e){enter();});$(document).on(clickHandler,'.load-more',function(){$grid.addItems(day);});$(document).on(clickHandler,'.day-dot a, .day-text a',function(){day=$(this).data("day");$("#view-grid,.load-more").data("day",day);$social.preload(day);internalSocial=true;}).on("mouseenter",'.day-dot a, .day-text a',function(){if($(this).is(".day-dot a")){day=$(this).data("day");$(".day-text a[data-day="+day+"]").addClass("press");}
else{day=$(this).data("day");$(".day-dot a[data-day="+day+"]").addClass("press");}}).on("mouseleave",'.day-dot a, .day-text a',function(){$(".day-text a, .day-dot a").removeClass("press");});$(document).on(clickHandler,'#back',function(){$social.close();internalSocial=false;});$(document).on(clickHandler,'#view-grid',function(){day=$(this).data("day");element.dayDot.fadeOut();$cont.grid.css({"z-index":"10"});$cont.player.transition({opacity:0},200,function(){$grid.open(day,true);hidePrevNextDay(day);});map.cont.removeClass("running").addClass("paused");});$(document).on(clickHandler,'#back-grid',function(){element.dayDot.show();$grid.close();map.cont.removeClass("paused").addClass("running");});$(document).on(clickHandler,'#prev-day, #prev-text',function(){if($(this).css('opacity')==1){day=parseInt(day)>13?(parseInt(day)-1).toString():day;$("#view-grid").data("day",day);commonPrevNextDay(day);if($(this).is("#prev-day")){$("#grid").animate({scrollTop:0},500);}}});$(document).on(clickHandler,'#next-day, #next-text',function(){if($(this).css('opacity')==1){day=parseInt(day)<16?(parseInt(day)+1).toString():day;$("#view-grid").data("day",day);commonPrevNextDay(day);if($(this).is("#next-day")){$("#grid").animate({scrollTop:0},500);}}});$(document).on(clickHandler,'.video-dot a',function(e){var dayVideo=$(this).data("video");var offset=$(this).data("offset");$video.init(dayVideo,offset);map.cont.removeClass("running").addClass("paused");});$(document).on(clickHandler,'#back-home',function(){$video.close();map.cont.removeClass("paused").addClass("running");});$(document).on(clickHandler,'#player-prev',function(){player.prev();});$(document).on(clickHandler,'#player-next',function(){player.next();});$(document).on(clickHandler,'#player-play',function(){if(player.currents.status==="playing"){player.pause();gomusic=false;}
else{if(player.currents.status==="paused"){player.resume();gomusic=true;}}});function hidePrevNextDay(day){if(parseInt(day)<=13){$("#prev-day").css({"visibility":"hidden"});}
else{$("#prev-day").css({"visibility":"visible"});}
if(parseInt(day)>=16){$("#next-day").css({"visibility":"hidden"});}
else{$("#next-day").css({"visibility":"visible"});}}
function setCurrentDayMsg(){$(".current-day").text($social.getDayText(day));}
function commonPrevNextDay(){maingrid.transition({opacity:0},200,function(){nrThumb=16;$grid.open(day,false);setCurrentDayMsg();hidePrevNextDay();map.cont.removeClass("running").addClass("paused");});}},loadCircleCanvas=function(container){var loadedImageCount=0,imageCount;var contImages=container;initProgress();imgLoad=imagesLoaded(contImages);imgLoad.on('progress',onProgress);imgLoad.on('always',resetProgress);imageCount=imgLoad.images.length;function initProgress(){loadedImageCount=0;$cont.canvas.css({opacity:1});}
function resetProgress(){loadedImageCount=0;setTimeout(function(){$cont.canvas.transition({opacity:0},200);},800);}
function updateProgress(value){var percent=parseInt((value/imageCount)*100);loadCanvas(percent);}
function onProgress(imgLoad,image){loadedImageCount++;updateProgress(loadedImageCount);}},scrollPage=function(){var top=$cont.grid.scrollTop();var initial=-142;var header=$("#header-grid");if(top=="0"){header.removeClass("scroll");}
else{if(top>=140){header.addClass("scroll");}}
clearTimeout(timeout);timeout=setTimeout(function(){header.removeClass("scroll");},1500);},detectBrowser=function(){if((navigator.userAgent.indexOf('iPhone')==-1&&navigator.userAgent.indexOf('iPod')==-1&&navigator.userAgent.indexOf('iPad')==-1&&navigator.userAgent.indexOf('Android')==-1)){pc=true;device=false;if($("body").hasClass("ie")==true){ie=true;}}
else{pc=false;device=true;}},startLoad=function(){setTimeout(function(){$cont.loader.css({y:wHeight,opacity:1}).transition({y:0},800,"easeInOutExpo",function(){setTimeout(function(){loader();},800);});},1000);},loader=function(){var images=$('img');var totImages=images.length;var indexImages=0;var imagePreload=function(src,callback){el=document.createElement('img');el.setAttribute("src",src);$(el).on("load",function(){callback();});};images.each(function(i,el){var src=$(el).attr('src');imagePreload(src,function(){indexImages++;if(indexImages==(totImages)){goOut=true;}});});endLoad();},endLoad=function(){if(wWidth>480){var i=-585;}
else{var i=-487;}
var index=0,x=90,valTopIco,valTopText;var text=$("#cont-text-load"),days=$("#text-days"),ico=$(".ico-load"),icoCont=$("#cont-ico-load"),loadPercent=$(".load-percent"),pie=$(".pie");if(wWidth>480){valTopIco=20;valTopText=0;}
else{valTopIco=-10;valTopText=-50;}
icoCont.transition({opacity:1,top:valTopIco},400);text.transition({opacity:1,top:valTopText},400);setTimeout(function(){var loadImage=setInterval(function(){if(x<=360){days.transition({x:i,y:0},800,"easeInOutExpo");pie.transition({rotate:x+"deg"},500);}
if(x>180){loadPercent.addClass("half");pie.eq(1).addClass("fill");}
if(i>=0){if(goOut==true){clearInterval(loadImage);clearInterval(loadIcon);goFull=true;setTimeout(function(){leaveLoad();},1000);}}
x=x+90;if(wWidth>480){i=i+200;}
else{i=i+165;}},900);var loadIcon=setInterval(function(){$(ico[index]).addClass("show");ico.not(ico[index]).removeClass("show");index++;if(index===ico.length-1){index=0;}},300);},1000);function leaveLoad(){ico.removeClass("show");$(".eiffel").css({opacity:1});text.transition({top:'60px'},400,function(){$cont.loader.transition({scale:'0.9',opacity:0},300);});$cont.overlay.transition({opacity:0.7},300,function(){intro();});}
function intro(){$(".eiffel").delay(500).transition({y:'-80'},400,function(){$('#intro').addClass("animate-text").find("p").css({opacity:1});$("a.discover").css({y:'0'}).delay(1000).transition({y:'-10',opacity:1},300);});}},enter=function(){var cloud=$(".map-cloud-img"),indexCloud=0;var loadMap=setInterval(function(){$(cloud[indexCloud]).transition({opacity:0,x:500},2200);indexCloud++;if(indexCloud===cloud.length){clearInterval(loadMap);}},250);$('.eiffel').transition({y:'-90',opacity:0},500,function(){player.init();$cont.intro.transition({opacity:0,scale:'0.98'},300,"easeInOutQuad",function(){setTimeout(function(){home();},1000);});});},fullscreen=function(){this.opt={correctW:1600,correctH:1080,correctRatio:null,currentRatio:null,newW:wWidth,newH:wHeight,moveTop:0,moveLeft:0};opt.currentRatio=wWidth/wHeight;opt.correctRatio=opt.correctW/opt.correctH;if(opt.currentRatio<=opt.correctRatio){opt.newW=opt.newH*opt.correctRatio;opt.moveLeft=parseInt((opt.newW-wWidth)/2)*(-1);}
else{opt.newH=opt.newW/opt.correctRatio;opt.moveTop=parseInt((opt.newH-wHeight)/2)*(-1);}
this.optVideo={correctW:1280,correctH:700,correctRatio:null,currentRatio:null,newW:wWidth,newH:wHeight,moveTop:0,moveLeft:0};optVideo.currentRatio=wWidth/wHeight;optVideo.correctRatio=optVideo.correctW/optVideo.correctH;if(optVideo.currentRatio<=optVideo.correctRatio){optVideo.newW=optVideo.newH*optVideo.correctRatio;optVideo.moveLeft=parseInt((optVideo.newW-wWidth)/2)*(-1);}
else{optVideo.newH=optVideo.newW/optVideo.correctRatio;optVideo.moveTop=parseInt((optVideo.newH-wHeight)/2)*(-1);}
$(".fullscreen").css({'width':optVideo.newW+'px','height':optVideo.newH+'px','top':optVideo.moveTop+'px','left':optVideo.moveLeft+'px'});$(".map-grid img").css({'width':optVideo.newW+'px','height':optVideo.newH+'px','top':optVideo.moveTop+'px','left':optVideo.moveLeft+'px'});},home=function(){this.circle={internal:$("#circle-internal"),external:$("#circle-external"),video:$("#circle-video"),text:$(".circle-text"),logo:$(".circle-text h2"),brand:$(".brand")};this.map={cont:$("#mapClouds"),cloud:$(".map-cloud-img")};$("#loader,#intro").hide();$cont.home.show();circle.internal.transition({scale:'1',opacity:1},500,"easeInOutBack");circle.external.delay(300).transition({scale:'1',opacity:1},500,"easeInOutBack",function(){circle.logo.delay(100).transition({top:'0',opacity:1},300);circle.text.transition({opacity:1},200).addClass("fadeIn");setTimeout(function(){var topCircleText,topS3;if(wWidth<=768){topCircleText=40;topS3=26;}
else{topCircleText=70;topS3=47;}
circle.text.transition({top:topCircleText},500);$(".s3").transition({top:topS3},500);$(".sx, .dx").transition({paddingTop:'10px',paddingBottom:'5px'},500);$(".s1").transition({paddingTop:'5px',paddingBottom:'0px'},500);circle.logo.transition({paddingBottom:'10px'},500);circle.brand.transition({top:'25px',scale:'1'},500);var dim;if(wWidth<=768){dim={scale:'1'}}
else{dim={scale:'0.9'}}
circle.internal.transition(dim,500,function(){circle.video.transition({opacity:1},300);enterDays();});},1800);$(window).resize(function(){if(wWidth<=768){topCircleText=40;topS3=26;dim={scale:'1'}}
else{topCircleText=70;topS3=47;dim={scale:'0.9'}}
circle.text.css({top:topCircleText});$(".s3").css({top:topS3});circle.internal.css(dim);});});function enterPlayer(){$cont.player.transition({opacity:1},500);$("#view-grid").transition({opacity:1},500);setTimeout(function(){$("#player-prev").transition({left:0,opacity:1},500);$("#player-next").transition({left:'98px',opacity:1},400,function(){$("#player-title").transition({left:'150px',opacity:1},400);});},600);}
function enterDays(){if(wWidth>480){map.cont.addClass("js-animatedClouds");}
map.cloud.transition({opacity:1},500);var v=$(".day-dot, .video-dot");var cur=0;if(wWidth>480){for(var j,x,i=v.length;i;j=parseInt(Math.random()*i),x=v[--i],v[i]=v[j],v[j]=x);function fadeInNextLI(){v.eq(cur++).transition({scale:'1',opacity:1},400);if(cur!=v.length)setTimeout(fadeInNextLI,100);}
fadeInNextLI();}
$(".external-text").addClass("active");enterPlayer();}};return{init:init,size:sizePage,scroll:scrollPage,player:player};})();$Page.init();$(window).resize(function(){$Page.size();});$("#grid").scroll(function(){$Page.scroll();});var canvasTime=document.getElementById('playerTime');var ctx=canvasTime.getContext('2d');var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=requestAnimationFrame;var canvas=document.getElementById('myCanvas');var context=canvas.getContext('2d');var x=canvas.width/2;var y=canvas.height/2;var radius=280;var cur=0;var counterClockwise=true;var circ=Math.PI*2;var quart=Math.PI/2;context.lineWidth=5;context.strokeStyle='#fff';function loadCanvas(totCur){function animate(current){context.clearRect(0,0,canvas.width,canvas.height);context.beginPath();context.arc(x,y,radius,-(quart),((circ)*current)-quart,false);context.stroke();cur++;if(cur<=totCur){requestAnimationFrame(function(){animate(cur/100)});}}
animate();};});SC.initialize({client_id:'cbb8401fff74ceeee1a4387bc4033ba7'});var player={controls:{prev:$("#player-prev"),play:$("#player-play"),next:$("#player-next"),title:$("#player-title")},tracks:['https://soundcloud.com/lickingthevoid/sympathique-pink-martini','https://soundcloud.com/dalia-ashraf-negm/edith-piaf-la-vie-en-rose-1','https://soundcloud.com/80s-back/desireless-voyage-voyage-12','https://soundcloud.com/dhpvsssc1/les-feuilles-mortes','https://soundcloud.com/christopheverhaert/a-toi-joe-dassin','https://soundcloud.com/junnamatsuda/jane-birkin-serge-gainsbourg','https://soundcloud.com/francesco-della-valle-1/apres-la-classe-paris','https://soundcloud.com/undobleclic/ne-me-quitte-pas-jacques-21','https://soundcloud.com/emad-goda/audio-recording-on-monday-3','https://soundcloud.com/yasmin_r/edith-piaf-non-je-ne-regrette'],currents:{status:"stopped",index:0,track:{},sound:{},},n:0,init:function(){this.n=this.tracks.length;this.currents.index=0;this.play(this.currents.index);},prev:function(){if(this.currents.index>0){this.currents.sound.stop();this.play(this.currents.index-1);}},next:function(){if(this.currents.index<(this.n-1)){this.currents.sound.stop();this.play(this.currents.index+1);}},pause:function(){this.currents.status="paused";this.currents.sound.pause();this.changePlayCtrl(this.currents.status);},resume:function(){this.currents.status="playing";this.currents.sound.resume();this.changePlayCtrl(this.currents.status);},play:function(i){if(this.currents.status==="stopped"||(this.currents.status!=="stopped"&&i!==this.currents.index)){this.currents.index=i;var that=this;SC.get('/resolve',{url:this.tracks[i]},function(track){that.currents.track=track;that.updateTitle(that.currents.track.title);var innerThat=that;SC.stream('/tracks/'+that.currents.track.id,function(sound){innerThat.currents.sound=sound;innerThat.currents.sound.play({volume:50,onfinish:function(){innerThat.next();}});innerThat.currents.status="playing";innerThat.changePlayCtrl(innerThat.currents.status);innerThat.managePrevNext(innerThat.currents.index);});});}},changePlayCtrl:function(status){if(status==="playing"){player.controls.play.removeClass().addClass("pause")}
else{if(status==="paused"){player.controls.play.removeClass().addClass("play")}}},managePrevNext:function(i){if(i==0){player.controls.prev.addClass("disabled");}
else{player.controls.prev.removeClass("disabled");}
if(i==(this.n-1)){player.controls.next.addClass("disabled");}
else{player.controls.next.removeClass("disabled");}},updateTitle:function(title){player.controls.title.text(title);}};